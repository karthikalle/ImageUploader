package dataEntryTesting;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;

import javax.swing.JOptionPane;

import org.junit.Before;
import org.junit.Test;

import com.amazonaws.auth.PropertiesCredentials;
import com.amazonaws.services.simpledb.AmazonSimpleDB;
import com.amazonaws.services.simpledb.model.Item;
import com.amazonaws.services.simpledb.model.SelectRequest;
import com.amazonaws.services.simpledb.AmazonSimpleDBClient;

import dataEntry.GUI_DataEntry;
import junit.framework.Assert;
import junit.framework.TestCase;

public class UploadToSimpleDBTest {
	
	public AmazonSimpleDB sdb;
	
	@Before
	public void setUp () {
		try{
	
		sdb = new AmazonSimpleDBClient(new PropertiesCredentials(
		        GUI_DataEntry.class.getResourceAsStream("AwsCredentials.properties")));
		}
		catch (Exception e){
			System.out.println(e);
		}
	}
	
	@Test
	public void uploadImageData() {
		
			GUI_DataEntry gde = new GUI_DataEntry(){
				public boolean validateAndGetCategory() {
					return true;
				}
				public boolean validateImageName(){
					return true;
				}
				public boolean checkIfAlreadyExistsAndReplace() {
					return true;
				}
				public String uploadImageToS3(){
					return "testURL";
				}
			};
			String imageName = "SaucePan";
			
			gde.showDialogs=false;
			gde.word = imageName;	
			gde.frequency = "4";
			gde.imageability = "6";
			gde.categoryName= "testCategory";
			gde.uploadToSimpleDB();
			
			String selectExpression = "select * from `" + "mossWords" + "` where itemName() = '"+imageName+"'";
		    SelectRequest selectRequest = new SelectRequest(selectExpression);
	
		    String itemName=""; 
		    for(Item item: sdb.select(selectRequest).getItems()) {
		    		itemName = item.getName().toString();
		    }	
		    	assertEquals(imageName, itemName);
	}
	
	@Test
	public void testImageNameEmpty() {
		GUI_DataEntry gde = new GUI_DataEntry();
		gde.word = "";
		gde.showDialogs=false;		
		assertFalse(gde.validateImageName());

	}
	
	@Test
	public void testImageNameValid() {
		GUI_DataEntry gde = new GUI_DataEntry();
		gde.word = "Cup";
		gde.showDialogs=false;		
		assertTrue(gde.validateImageName());
	}
	
	@Test
	public void testImageAlreadyExists() {
		
		GUI_DataEntry gde = new GUI_DataEntry();
		gde.word = "Cup";
		gde.showDialogs=false;		
		assertTrue(gde.checkIfAlreadyExistsAndReplace());
	}
}